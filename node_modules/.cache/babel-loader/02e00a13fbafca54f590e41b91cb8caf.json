{"remainingRequest":"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/babel-loader/lib/index.js!/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/vuetify-loader/lib/loader.js!/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/src/views/Sends/SendForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/src/views/Sends/SendForm.vue","mtime":1585119550000},{"path":"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/vuetify-loader/lib/loader.js","mtime":1564062719000},{"path":"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport _defineProperty from \"/Users/jin/Desktop/v-cloud-feature-common-component/token-service/wallet/ui/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport transaction from \"@/libs1/transaction\";\nimport crypto from \"@/libs1/crypto\";\nimport { mapState, mapGetters } from \"vuex\";\nexport default {\n  data: function data() {\n    var _this = this;\n\n    return {\n      fee: 0.1,\n      amount: \"\",\n      valid: false,\n      sendConfirm: false,\n      sendInfo: {},\n      recipient: \"\",\n      Description: \"\",\n      networkType: this.$config.NET_BYTE,\n      activeTab: 0,\n      //hot or cold\n      vsysBalance: 0,\n      hotAddrKeyPair: {},\n      sendPromp: \"\",\n      rules: {\n        maxLength: function maxLength(f) {\n          return function (v) {\n            if (v && v.length) {\n              return v.length < f || \"Description shouldn't be longer than \".concat(f, \".\");\n            } else {\n              return true;\n            }\n          };\n        },\n        required: function required(f) {\n          return function (v) {\n            return !!v || \"\".concat(f, \" is required\");\n          };\n        },\n        validAddr: function validAddr(netByte) {\n          return function (v) {\n            var reg = /[1-9a-km-zA-HJ-NP-Z]/;\n\n            if (v) {\n              var _iteratorNormalCompletion = true;\n              var _didIteratorError = false;\n              var _iteratorError = undefined;\n\n              try {\n                for (var _iterator = v[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  var i = _step.value;\n                  if (!reg.test(i)) return \"Invalid address\";\n                }\n              } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion && _iterator.return != null) {\n                    _iterator.return();\n                  }\n                } finally {\n                  if (_didIteratorError) {\n                    throw _iteratorError;\n                  }\n                }\n              }\n            }\n\n            return crypto.isValidAddress(v, netByte) && _this.wallets[_this.currentIndex].address != v || \"Invalid address\";\n          };\n        },\n        validPublicKey: function validPublicKey(addr, netByte) {\n          return function (v) {\n            return crypto.isValidPublicKey(v, addr, netByte) || \"Invalid publicKey\";\n          };\n        },\n        maxAmount: function maxAmount(f) {\n          return function (v) {\n            return Number(v) <= Number(f) || \"Insufficient Balance\";\n          };\n        },\n        validAmount: function validAmount() {\n          return function (v) {\n            if (v && Number(v)) {\n              var a = _this.$utils.Big(v).times(_this.unity).toFixed();\n\n              if (a) {\n                if (a.indexOf(\".\") !== -1) return \"Too many decimal\";\n                if (a.length > 20) return \"No longer than 20 bits\";\n              }\n            }\n\n            return /^([1-9]\\d*|0)(\\.\\d{0,20})?$/.test(v) || \"\".concat(v, \" is not valid\");\n          };\n        }\n      }\n    };\n  },\n  created: function created() {\n    this.getVSYS();\n    this.fee = window.constants.TOKEN_ID === \"VSYS Coin\" ? window.constants.TX_FEE.Default : window.constants.TX_FEE.ContractExec;\n    this.precision = this.unity;\n    this.recipient = this.$store.state.sendInfo.recipient;\n    this.amount = this.$store.state.sendInfo.amount;\n    this.Description = this.$store.state.sendInfo.description;\n  },\n  computed: _objectSpread({}, mapState([\"wallets\", \"currentIndex\", \"unity\"]), {}, mapGetters([\"balance\"])),\n  methods: {\n    goConfirm: function goConfirm() {\n      if (!this.$refs.form.validate()) return; // Info of Send Confirm Dialog\n\n      this.sendInfo = {\n        From: this.wallets[this.currentIndex].address,\n        To: this.recipient,\n        Type: \"Payment\",\n        Amount: this.amount,\n        Fee: this.fee,\n        Description: this.Description\n      };\n      this.sendConfirm = true;\n    },\n    getVSYS: function getVSYS() {\n      this.$store.dispatch(\"update_vsys\", this.currentIndex);\n    },\n    handleCancel: function handleCancel() {\n      if (this.$store.state.loginType === \"send\") {\n        this.$router.replace({\n          path: \"/home/shift\"\n        });\n      } else {\n        this.$store.commit(\"reset_sendinfo\");\n        this.$router.replace({\n          path: \"/home\"\n        });\n      }\n    },\n    routerBtn: function routerBtn() {\n      var _this2 = this;\n\n      if (!this.$refs.form.validate()) return;\n\n      if (this.$store.state.tokenid === \"VSYS Coin\") {// const dataInfo = {\n        //   recipient: this.recipient,\n        //   amount: parseInt(this.amount * this.precision),\n        //   fee: parseInt(this.fee * constants.VSYS_PRECISION),\n        //   feeScale: constants.FEE_SCALE,\n        //   timestamp: Date.now(),\n        //   attachment: this.Description\n        // };\n        // this.doPayment = apiSchema => {\n        //   axios\n        //     .post(`http://18.218.106.1:9922/vsys/broadcast/payment`, apiSchema)\n        //     .then(dealRes)\n        //     .catch(dealErr);\n        // };\n        // if (this.activeTab === 0) {//hot wallet\n        //   let apiSchema = transaction.prepareForAPI(\n        //     dataInfo,\n        //     this.hotAddrKeyPair['AUAztxsft2v6rmjRRb72nLea6BNyRHHWpUR'],\n        //     constants.TRANSACTION_TYPE.PAYMENT_TX\n        //   );\n        //   this.doPayment(apiSchema);\n        // } else {\n        //   this.txType = constants.TRANSACTION_TYPE.PAYMENT_TX;\n        //   this.toSign = dataInfo;\n        // }\n      } else {\n        var contractId = transaction.tokenIdToContractId(this.$config.tokenId);\n        console.log(contractId);\n        var dataInfo = {\n          contractId: contractId,\n          functionIndex: this.$store.state.canSplit ? 4 : 3,\n          functionData: transaction.prepareTokenSendFuncDataStr(this.recipient, parseInt(this.amount * this.precision)),\n          attachment: this.Description || \"\",\n          fee: parseInt(this.fee * window.constants.VSYS_PRECISION),\n          feeScale: window.constants.FEE_SCALE,\n          timestamp: Date.now() * 1e6\n        }; //hot wallet\n\n        if (this.activeTab === 0) {\n          var apiSchema = transaction.prepareForAPI(dataInfo, this.wallets[this.currentIndex].keyPair, window.constants.TRANSACTION_TYPE.CONTRACT_EXEC_TX); //update send info in store\n\n          this.$store.commit(\"update_sendInfo\", {\n            recipient: this.recipient,\n            amount: this.amount,\n            description: this.Description || \"\"\n          }); //transaction broadcast\n\n          this.$axios.post(\"\".concat(this.$config.vsysEndPoint, \"/contract/broadcast/execute\"), apiSchema).then(function (res) {\n            if (res.status === 200) {\n              _this2.$store.commit(\"update_loginType\", \"\");\n\n              _this2.$router.replace({\n                path: \"/home/send/finish\"\n              });\n            }\n          }).catch(function (err) {\n            if (err.response && err.response.status === 400) {\n              console.log(err.response);\n\n              if (err.response.data.error === 112) {\n                _this2.sendPromp = \"Not enough VSYS.\";\n              }\n            } else {\n              _this2.sendPromp = \"Sorry,Transaction form submission failed\";\n            }\n          });\n        } else {\n          //cold wallet\n          this.txType = window.constants.TRANSACTION_TYPE.CONTRACT_EXEC_TX;\n          this.toSign = dataInfo;\n        }\n      }\n    }\n  }\n};",{"version":3,"sources":["SendForm.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"mt-6\">\n    <div class=\"pt-6 pb-6 px-4 white font15\" style=\"border-radius: 16px;\">\n      <p class=\"send-title SF-Text-Medium\">Wallet Address</p>\n      <p\n        class=\"secondary py-4 pl-3 pr-6 text-break SF-Text-Regular\"\n        style=\"border-radius: 4px\"\n      >\n        {{ wallets[currentIndex].address }}\n      </p>\n      <div class=\"mb-6 color-grey\">\n        <span class=\"SF-Display-Regular\" style=\"margin-right: 6px;\"\n          >Available Balance:</span\n        >\n        <div class=\"bal-outer\">\n          <span class=\"DIN-Alternate-Bold bal-inner\">{{\n            $utils.toThousands(balance)\n          }}</span>\n        </div>\n      </div>\n\n      <p class=\"send-title\">Recipient</p>\n      <v-form ref=\"form\" v-model=\"valid\">\n        <v-textarea\n          flat\n          solo\n          clearable\n          no-resize\n          v-model=\"recipient\"\n          background-color=\"secondary\"\n          label=\"Please input the recipient address\"\n          :rules=\"[rules.required('Address'), rules.validAddr(networkType)]\"\n        ></v-textarea>\n\n        <p class=\"send-title\">Amount</p>\n        <v-text-field\n          flat\n          solo\n          clearable\n          v-model=\"amount\"\n          background-color=\"secondary\"\n          label=\"Please input send amount\"\n          :rules=\"[\n            rules.required('Amount'),\n            rules.validAmount(),\n            rules.maxAmount(balance)\n          ]\"\n        ></v-text-field>\n\n        <p class=\"send-title\">Description</p>\n        <v-text-field\n          flat\n          v-model=\"Description\"\n          solo\n          background-color=\"secondary\"\n          label=\"Optional\"\n          clearable\n          :rules=\"[rules.maxLength(150)]\"\n        ></v-text-field>\n      </v-form>\n      <div class=\"color-grey\">\n        <span class=\"SF-Display-Regular\" style=\"margin-right: 6px\"\n          >Transaction Fee:\n        </span>\n        <span class=\"DIN-Alternate-Bold\"\n          >{{ fee }} <span class=\"SF-Text-Regular\">VSYS</span></span\n        >\n      </div>\n      <div class=\"mt-1 color-grey\">\n        <span class=\"SF-Display-Regular\" style=\"margin-right: 6px\"\n          >Available:\n        </span>\n        <span class=\"DIN-Alternate-Bold\"\n          >{{ wallets[currentIndex].vsysBalance }}\n          <span class=\"SF-Text-Regular\">VSYS</span></span\n        >\n      </div>\n    </div>\n    <!-- Send Form Promp -->\n    <div\n      style=\"color: var(--v-error-base);font-size: 12px; height: 24px; line-height: 24px\"\n    >\n      <span class=\"px-3\" v-show=\"sendPromp\">{{ sendPromp }}</span>\n    </div>\n    <v-btn\n      block\n      height=\"52px\"\n      color=\"primary\"\n      dark\n      class=\"text-none\"\n      style=\"border-radius: 8px\"\n      @click.native=\"goConfirm\"\n    >\n      <span class=\"SF-Text-Medium font18\">Continue</span>\n    </v-btn>\n    <v-btn\n      block\n      height=\"52px\"\n      class=\"text-none primary--text mt-3 mb-4 SF-Text-Medium btn-border\"\n      style=\"border-radius: 8px\"\n      @click=\"handleCancel\"\n    >\n      <div class=\"font18\">Cancel</div>\n    </v-btn>\n    <!-- send confirm dialog-->\n    <v-dialog v-model=\"sendConfirm\" transition=\"dialog-bottom-transition\">\n      <v-card calss=\"send-card\" style=\"border-radius: 16px 16px 0 0\">\n        <div class=\"mx-5 mb-0\">\n          <div\n            class=\"py-4 text-center font18 SF-Text-Medium\"\n            style=\"color:#444444\"\n          >\n            Review Transaction\n          </div>\n          <div\n            v-for=\"(item, name) in sendInfo\"\n            :key=\"name\"\n            class=\"send-item font14\"\n          >\n            <div class=\"SF-Text-Light mb-2 color-grey\">\n              {{ name }}\n            </div>\n            <div class=\"SF-Text-Regular\" style=\"color:#333333\">{{ item }}</div>\n          </div>\n        </div>\n        <div\n          style=\"color: var(--v-error-base);font-size: 12px; height: 24px; line-height: 24px\"\n        >\n          <span class=\"px-3\" v-show=\"sendPromp\">{{ sendPromp }}</span>\n        </div>\n        <div\n          class=\"d-flex mx-4 justify-space-between pb-6 SF-Text-Medium font16\"\n        >\n          <div style=\"width: 44.53vw\">\n            <v-btn\n              block\n              height=\"52px\"\n              class=\"text-none black--text btn-border\"\n              style=\"border-radius: 8px\"\n              @click=\"sendConfirm = false\"\n            >\n              <div>Cancel</div>\n            </v-btn>\n          </div>\n          <div style=\"width: 44.53vw\">\n            <v-btn\n              block\n              height=\"52px\"\n              color=\"primary\"\n              dark\n              class=\"text-none\"\n              style=\"border-radius: 8px;\"\n              @click=\"routerBtn\"\n            >\n              <span>Send</span>\n            </v-btn>\n          </div>\n        </div>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\nimport transaction from \"@/libs1/transaction\";\nimport crypto from \"@/libs1/crypto\";\nimport { mapState, mapGetters } from \"vuex\";\n\nexport default {\n  data() {\n    return {\n      fee: 0.1,\n      amount: \"\",\n      valid: false,\n      sendConfirm: false,\n      sendInfo: {},\n      recipient: \"\",\n      Description: \"\",\n      networkType: this.$config.NET_BYTE,\n      activeTab: 0, //hot or cold\n      vsysBalance: 0,\n      hotAddrKeyPair: {},\n      sendPromp: \"\",\n      rules: {\n        maxLength: f => {\n          return v => {\n            if (v && v.length) {\n              return (\n                v.length < f || `Description shouldn't be longer than ${f}.`\n              );\n            } else {\n              return true;\n            }\n          };\n        },\n        required: f => {\n          return v => !!v || `${f} is required`;\n        },\n        validAddr: netByte => {\n          return v => {\n            let reg = /[1-9a-km-zA-HJ-NP-Z]/;\n            if (v) {\n              for (let i of v) {\n                if (!reg.test(i)) return \"Invalid address\";\n              }\n            }\n            return (\n              (crypto.isValidAddress(v, netByte) &&\n                this.wallets[this.currentIndex].address != v) ||\n              \"Invalid address\"\n            );\n          };\n        },\n        validPublicKey: (addr, netByte) => {\n          return v =>\n            crypto.isValidPublicKey(v, addr, netByte) || \"Invalid publicKey\";\n        },\n        maxAmount: f => {\n          return v => Number(v) <= Number(f) || \"Insufficient Balance\";\n        },\n        validAmount: () => {\n          return v => {\n            if (v && Number(v)) {\n              let a = this.$utils\n                .Big(v)\n                .times(this.unity)\n                .toFixed();\n              if (a) {\n                if (a.indexOf(\".\") !== -1) return \"Too many decimal\";\n                if (a.length > 20) return \"No longer than 20 bits\";\n              }\n            }\n            return /^([1-9]\\d*|0)(\\.\\d{0,20})?$/.test(v) || `${v} is not valid`;\n          };\n        }\n      }\n    };\n  },\n  created() {\n    this.getVSYS();\n    this.fee =\n      window.constants.TOKEN_ID === \"VSYS Coin\"\n        ? window.constants.TX_FEE.Default\n        : window.constants.TX_FEE.ContractExec;\n    this.precision = this.unity;\n    this.recipient = this.$store.state.sendInfo.recipient;\n    this.amount = this.$store.state.sendInfo.amount;\n    this.Description = this.$store.state.sendInfo.description;\n  },\n\n  computed: {\n    ...mapState([\"wallets\", \"currentIndex\", \"unity\"]),\n    ...mapGetters([\"balance\"])\n  },\n\n  methods: {\n    goConfirm() {\n      if (!this.$refs.form.validate()) return;\n      // Info of Send Confirm Dialog\n      this.sendInfo = {\n        From: this.wallets[this.currentIndex].address,\n        To: this.recipient,\n        Type: \"Payment\",\n        Amount: this.amount,\n        Fee: this.fee,\n        Description: this.Description\n      };\n      this.sendConfirm = true;\n    },\n    getVSYS() {\n      this.$store.dispatch(\"update_vsys\", this.currentIndex);\n    },\n    handleCancel() {\n      if (this.$store.state.loginType === \"send\") {\n        this.$router.replace({ path: \"/home/shift\" });\n      } else {\n        this.$store.commit(\"reset_sendinfo\");\n        this.$router.replace({ path: \"/home\" });\n      }\n    },\n    routerBtn() {\n      if (!this.$refs.form.validate()) return;\n      if (this.$store.state.tokenid === \"VSYS Coin\") {\n        // const dataInfo = {\n        //   recipient: this.recipient,\n        //   amount: parseInt(this.amount * this.precision),\n        //   fee: parseInt(this.fee * constants.VSYS_PRECISION),\n        //   feeScale: constants.FEE_SCALE,\n        //   timestamp: Date.now(),\n        //   attachment: this.Description\n        // };\n        // this.doPayment = apiSchema => {\n        //   axios\n        //     .post(`http://18.218.106.1:9922/vsys/broadcast/payment`, apiSchema)\n        //     .then(dealRes)\n        //     .catch(dealErr);\n        // };\n        // if (this.activeTab === 0) {//hot wallet\n        //   let apiSchema = transaction.prepareForAPI(\n        //     dataInfo,\n        //     this.hotAddrKeyPair['AUAztxsft2v6rmjRRb72nLea6BNyRHHWpUR'],\n        //     constants.TRANSACTION_TYPE.PAYMENT_TX\n        //   );\n        //   this.doPayment(apiSchema);\n        // } else {\n        //   this.txType = constants.TRANSACTION_TYPE.PAYMENT_TX;\n        //   this.toSign = dataInfo;\n        // }\n      } else {\n        let contractId = transaction.tokenIdToContractId(this.$config.tokenId);\n        console.log(contractId);\n        const dataInfo = {\n          contractId: contractId,\n          functionIndex: this.$store.state.canSplit ? 4 : 3,\n          functionData: transaction.prepareTokenSendFuncDataStr(\n            this.recipient,\n            parseInt(this.amount * this.precision)\n          ),\n          attachment: this.Description || \"\",\n          fee: parseInt(this.fee * window.constants.VSYS_PRECISION),\n          feeScale: window.constants.FEE_SCALE,\n          timestamp: Date.now() * 1e6\n        };\n        //hot wallet\n        if (this.activeTab === 0) {\n          let apiSchema = transaction.prepareForAPI(\n            dataInfo,\n            this.wallets[this.currentIndex].keyPair,\n            window.constants.TRANSACTION_TYPE.CONTRACT_EXEC_TX\n          );\n          //update send info in store\n          this.$store.commit(\"update_sendInfo\", {\n            recipient: this.recipient,\n            amount: this.amount,\n            description: this.Description || \"\"\n          });\n          //transaction broadcast\n          this.$axios\n            .post(\n              `${this.$config.vsysEndPoint}/contract/broadcast/execute`,\n              apiSchema\n            )\n            .then(res => {\n              if (res.status === 200) {\n                this.$store.commit(\"update_loginType\", \"\");\n                this.$router.replace({\n                  path: \"/home/send/finish\"\n                });\n              }\n            })\n            .catch(err => {\n              if (err.response && err.response.status === 400) {\n                console.log(err.response);\n                if (err.response.data.error === 112) {\n                  this.sendPromp = \"Not enough VSYS.\";\n                }\n              } else {\n                this.sendPromp = \"Sorry,Transaction form submission failed\";\n              }\n            });\n        } else {\n          //cold wallet\n          this.txType = window.constants.TRANSACTION_TYPE.CONTRACT_EXEC_TX;\n          this.toSign = dataInfo;\n        }\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.bal-inner {\n  width: 30vw;\n}\n.bal-outer {\n  vertical-align: middle;\n  display: inline-block;\n  width: 40vw;\n  overflow-x: scroll;\n  overflow-y: hidden;\n  scrollbar-width: none;\n}\n.bal-outer::-webkit-scrollbar {\n  display: none;\n}\n.v-dialog__content {\n  display: flex;\n  align-items: flex-end;\n}\n.v-dialog__content >>> .v-dialog--active {\n  border-radius: 0;\n  margin: 0;\n  /* max-height: 100%; */\n}\n.send-item {\n  padding: 14px 0 14px 0;\n  border-bottom: 1px solid #f5f5f7;\n  line-height: 16px;\n}\ndiv p {\n  margin-bottom: 12px;\n}\n.send-title {\n  font-size: 15px;\n  color: #444444;\n}\n.v-text-field >>> .v-label {\n  font-family: \"SFProText-Regular\", \"SFProText\", \"SF Pro Text Regular\";\n  font-weight: 400;\n  font-size: 15px;\n  color: #9e9e9e;\n  max-width: 100%;\n}\n.v-textarea >>> textarea {\n  height: 40px;\n  margin: 16px 0 16px 0 !important;\n  font-size: 15px;\n  padding: 0 0 0 0 !important;\n  scrollbar-width: none;\n}\n.v-textarea >>> textarea::-webkit-scrollbar {\n  display: none;\n}\n</style>\n"],"sourceRoot":"src/views/Sends"}]}